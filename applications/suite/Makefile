include Make.inc

EXE = suite.exe
EXE2 = suite_new.exe

OBJS += 	computeGraph.o \
		connectedComponents.o \
		genScalData.o \
		globals.o \
		graph-manip.o \
		pathIsomorphism.o \
		timer.o \
		triangles.o \
		util.o \
		xmalloc.o \
		centrality.o \
		compat/mersenne.o

OBJS2 = $(filter-out centrality.o,$(OBJS)) centrality_new.o

all: $(EXE) make_snaps.exe
	
$(EXE): main.o $(OBJS) $(COMPATLIB) $(IOLIB)
	$(LD) $(LDFLAGS) -o $@ $^ $(LIBS)
$(EXE2): main.o $(OBJS2) $(COMPATLIB) $(IOLIB)
	$(LD) $(LDFLAGS) -o $@ $^ $(LIBS)

make_snaps.exe: make_snaps.c
	gcc -std=c99 -o $@ $^

main.o: defs.h ../graph500/compatio.h
computeGraph.o: computeGraph.c defs.h
connectedComponents.o: connectedComponents.c defs.h
genScalData.o: genScalData.c defs.h
globals.o:		globals.c defs.h
graph-manip.o: graph-manip.c defs.h
pathIsomorphism.o: pathIsomorphism.c defs.h
timer.o: timer.c defs.h
triangles.o: triangles.c defs.h
util.o: util.c defs.h
xmalloc.o: xmalloc.c defs.h
centrality.o: centrality.c defs.h compat/mersenne.c
centrality_new.o: centrality_new.c defs.h compat/mersenne.c
compat/mersenne.o: compat/mersenne.c compat/mersenne.h

$(IOLIB) $(COMPATLIB):
	$(MAKE) -C $(IOLIB_DIR)

.c.o:
	$(CC) $(CFLAGS) -c $<

clean:
	rm -f *.o $(EXE2) $(EXE){,.pl,.ap2} profile.out trace.out
	-if test -n "$(IOLIB_DIR)" ; then make -C $(IOLIB_DIR) clean; fi

distclean:
	rm -f *.o $(EXE)
	-if test -n "$(IOLIB_DIR)" ; then make -C $(IOLIB_DIR) clean; fi

